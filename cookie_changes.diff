diff -r phpAdsNew/adclick.php /var/www/html/Awarez/phpadsnew/adclick.php
50a51,55
> // Determine the unique cookie id.
> $cookieid = phpAds_getCookieID();
> // Send the cookie...
> phpAds_setCookie ("phpAds_id", $cookieid, time() + 365*24*60*60);
> 
122c127
< 				phpAds_logClick($bannerid, $clientid, $zoneid, $source);
---
> 				phpAds_logClick($cookieid, $bannerid, $clientid, $zoneid, $source);
Only in /var/www/html/Awarez/phpadsnew: adconversion.php
diff -r phpAdsNew/adlog.php /var/www/html/Awarez/phpadsnew/adlog.php
47a48,52
> // Determine the unique cookie id.
> $cookieid = phpAds_getCookieID();
> // Send the cookie...
> phpAds_setCookie ("phpAds_id", $cookieid, time() + 365*24*60*60);
> 
60c65
< 			phpAds_logImpression ($bannerid, $clientid, $zoneid, $source);
---
> 			phpAds_logImpression ($cookieid, $bannerid, $clientid, $zoneid, $source);
diff -r phpAdsNew/adview.php /var/www/html/Awarez/phpadsnew/adview.php
58c58,62
< $url = parse_url($phpAds_config['url_prefix']);
---
> // Determine the unique cookie id.
> $cookieid = phpAds_getCookieID();
> // Send the cookie...
> phpAds_setCookie ("phpAds_id", $cookieid, time() + 365*24*60*60);
> 
59a64
> $url = parse_url($phpAds_config['url_prefix']);
125c130
< 			phpAds_logImpression ($row['bannerid'], $row['clientid'], $row['zoneid'], $source);
---
> 			phpAds_logImpression ($cookieid, $row['bannerid'], $row['clientid'], $row['zoneid'], $source);
diff -r phpAdsNew/config.inc.php /var/www/html/Awarez/phpadsnew/config.inc.php
3,7d2
< // IMPORTANT! DO NOT MANUALLY EDIT THIS FILE! 
< // IF YOU WANT TO INSTALL PHPADSNEW PLEASE FOLLOW 
< // THE INSTRUCTIONS IN THE ADMINISTRATOR GUIDE.
< 
< 
28a24
> $phpAds_config['tbl_adconversions'] = 'phpads_adconversions';
120a113,115
> // Enabled logging of adconversions?
> $phpAds_config['log_adconversions'] = true;
> 
diff -r phpAdsNew/libraries/lib-io.inc.php /var/www/html/Awarez/phpadsnew/libraries/lib-io.inc.php
15c15,16
< 
---
> // Set define to prevent duplicate include
> define ('LIBIO_INCLUDED', true);
122a124,144
> function phpAds_getCookieID($create=true)
> {
> 	global $phpAds_config, $HTTP_COOKIE_VARS, $HTTP_SERVER_VARS;
> 	
> 	$cookieid = $HTTP_COOKIE_VARS['phpAds_id'];
> 	if ( !isset($cookieid) && $create )
> 	{
> 		// Create a unique ID.  This is done by combining the web server's address, remote address, and microtime.
> 		$remote_address = $HTTP_SERVER_VARS['REMOTE_ADDR'];
> 		$local_address = $phpAds_config['url_prefix'];  //How do I get the IP address of this server?
> 		//Get the exact time
> 		list($usec, $sec) = explode(" ", microtime());
> 		$time = (float) $usec + (float) $sec;
> 		// Get a random number
> 		$random = 32432423;  // How do I generate a random number?
> 		$cookieid = md5($local_address.$time.$remote_address.$random);  // Need to find a way to generate this...
> 	}
> 	
> 	return $cookieid;
> }
> 
diff -r phpAdsNew/libraries/lib-log.inc.php /var/www/html/Awarez/phpadsnew/libraries/lib-log.inc.php
161c161
< function phpAds_logImpression ($bannerid, $clientid, $zoneid, $source)
---
> function phpAds_logImpression ($cookieid, $bannerid, $clientid, $zoneid, $source)
196c196
< 				$phpAds_config['tbl_adviews']." SET bannerid = '".$bannerid."', 
---
> 				$phpAds_config['tbl_adviews']." SET cookieid = '".$cookieid."', bannerid = '".$bannerid."', 
211c211
< function phpAds_logClick($bannerid, $clientid, $zoneid, $source)
---
> function phpAds_logClick($cookieid, $bannerid, $clientid, $zoneid, $source)
245c245
< 				$phpAds_config['tbl_adclicks']." SET bannerid = '".$bannerid."', zoneid = '".$zoneid."',
---
> 				$phpAds_config['tbl_adclicks']." SET cookieid = '".$cookieid."', bannerid = '".$bannerid."', zoneid = '".$zoneid."',
252a253,299
> /*********************************************************/
> /* Log an conversion                                          */
> /*********************************************************/
> 
> function phpAds_logConversion($cookieid, $bannerid, $clientid, $zoneid, $source)
> {
> 	global $HTTP_SERVER_VARS, $phpAds_config, $phpAds_CountryLookup;
> 	
> 	
> 	if ($host = phpads_logCheckHost())
> 	{
> 		$log_source = $phpAds_config['log_source'] ? $source : '';
> 		
> /*   		if ($phpAds_config['compact_stats'])
> 	    {
>     	    $result = phpAds_dbQuery(
> 				"UPDATE ".($phpAds_config['insert_delayed'] ? 'LOW_PRIORITY' : '')." ".
> 				$phpAds_config['tbl_adstats']." SET clicks = clicks + 1 WHERE day = NOW() AND
> 				hour = HOUR(NOW()) AND bannerid = '".$bannerid."' AND zoneid = '".$zoneid."' AND
> 				source = '".$log_source."' ");
> 			
> 	        if (phpAds_dbAffectedRows() == 0) 
>         	{
>             	$result = phpAds_dbQuery(
> 					"INSERT ".($phpAds_config['insert_delayed'] ? 'DELAYED' : '')." INTO ".
> 					$phpAds_config['tbl_adstats']." SET clicks = 1, views = 0, day = NOW(),
> 					hour = HOUR(NOW()), bannerid = '".$bannerid."', zoneid = '".$zoneid."',
> 					source = '".$log_source."' ");
> 	        }
>     	}
> 		else
> 		{
> */
> 		$log_country = $phpAds_config['geotracking_stats'] && $phpAds_geo && $phpAds_geo['country'] ? $phpAds_geo['country'] : '';
> 		$log_host    = $phpAds_config['log_hostname'] ? $HTTP_SERVER_VARS['REMOTE_HOST'] : '';
> 		$log_host    = $phpAds_config['log_iponly'] ? $HTTP_SERVER_VARS['REMOTE_ADDR'] : $log_host;
> 			
>     		$result = phpAds_dbQuery(
> 				"INSERT ".($phpAds_config['insert_delayed'] ? 'DELAYED' : '')." INTO ".
> 				$phpAds_config['tbl_adconversions']." SET cookieid = '".$cookieid."', bannerid = '".$bannerid."', zoneid = '".$zoneid."',
> 				host = '".$log_host."', source = '".$log_source."', country = '".$log_country."' ");
> //		}
> 		
> //		phpAds_logExpire ($clientid, phpAds_Clicks);
> 	}
> }
> 
diff -r phpAdsNew/libraries/lib-view-main.inc.php /var/www/html/Awarez/phpadsnew/libraries/lib-view-main.inc.php
14a15,16
> if (!defined('LIBIO_INCLUDED'))
> 	include (phpAds_path.'/libraries/lib-io.inc.php');
29a32
> 	$cookieid = phpAds_getCookieID();
210c213
< 			phpAds_logImpression ($row['bannerid'], $row['clientid'], $row['zoneid'], $source);
---
> 			phpAds_logImpression ($cookieid, $row['bannerid'], $row['clientid'], $row['zoneid'], $source);
